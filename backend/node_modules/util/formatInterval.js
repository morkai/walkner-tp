// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

'use strict';

const moment = require('moment');

module.exports = function formatInterval(interval, time, utc = false)
{
  const m = utc ? moment.utc(time) : moment(time);

  switch (interval)
  {
    case 'min':
      return m.format('YYYY-MM-DD HH:mm');

    case 'hour':
      return m.format('YYYY-MM-DD HH[:00]');

    case 'shift':
      return m.format(`YYYY-MM-DD[ ${resolveShift(m)}]`);

    case 'day':
      return m.format('YYYY-MM-DD');

    case 'week':
      return m.format(`GGGG-[W]WW`);

    case 'month':
      return m.format('YYYY-MM');

    case 'quarter':
      return m.format(`YYYY-[Q]Q`);

    case 'year':
      return m.format('YYYY');

    default:
      return m.format('YYYY-MM-DD HH:mm:ss');
  }
};

function resolveShift(m)
{
  const h = m.hours();

  if (h >= 6 && h < 14)
  {
    return 'I';
  }

  if (h >= 14 && h < 22)
  {
    return 'II';
  }

  return 'III';
}
